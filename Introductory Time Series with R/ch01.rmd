---
title: "Ch01 Time Series Data"
output: html_notebook
---
<!-- toc orderedList:0 depthFrom:1 depthTo:6 -->

- [1.1_Purpose 15](#11_purpose-15)
- [1.2_Time series 16](#12_time-series-16)
- [1.3_R language 17](#13_r-language-17)
- [1.4_Plots, trends, and seasonal variation 18](#14_plots-trends-and-seasonal-variation-18)
	- [1.4.1_A flying start: Air passenger bookings 18](#141_a-flying-start-air-passenger-bookings-18)
	- [1.4.2_Unemployment: Maine 21](#142_unemployment-maine-21)
	- [1.4.3_Multiple time series: Electricity, beer and chocolate data 24](#143_multiple-time-series-electricity-beer-and-chocolate-data-24)
	- [1.4.4_Quarterly exchange rate: GBP to NZ dollar 28](#144_quarterly-exchange-rate-gbp-to-nz-dollar-28)
	- [1.4.5_Global temperature series 30](#145_global-temperature-series-30)
- [1.5_Decomposition of series 33](#15_decomposition-of-series-33)
	- [1.5.1 Notation 33](#151-notation-33)
	- [1.5.2 Models 33](#152-models-33)
	- [1.5.3 Estimating trends and seasonal effects 34](#153-estimating-trends-and-seasonal-effects-34)
	- [1.5.4 Smoothing 35](#154-smoothing-35)
	- [1.5.5 Decomposition in R 36](#155-decomposition-in-r-36)
- [1.6_Summary of commands used in examples 38](#16_summary-of-commands-used-in-examples-38)
- [1.7_Exercises 38](#17_exercises-38)

<!-- tocstop -->

## 1.1_Purpose 15
## 1.2_Time series 16
## 1.3_R language 17
```{r}
Fact <- function(n) if (n == 1) 1 else n * Fact(n - 1)
Fact(5)
```
## 1.4_Plots, trends, and seasonal variation 18
### 1.4.1_A flying start: Air passenger bookings 18
```{r}
data(AirPassengers)
AP <- AirPassengers
AP
```

```{r}
class(AP)
```
```{r}
start(AP); end(AP); frequency(AP)
```
```{r}
plot(AP, ylab = "Passengers (1000's)")
```

### 1.4.2_Unemployment: Maine 21
```{r}
#www <- "http://www.massey.ac.nz/~pscowper/ts/Maine.dat"
www <- "DATA_ALL/Maine.dat"
Maine.month <- read.table(www, header = TRUE)
attach(Maine.month)
class(Maine.month)
```
```{r}
Maine.month.ts <- ts(unemploy, start = c(1996, 1), freq = 12)
```
```{r}
Maine.annual.ts <- aggregate(Maine.month.ts)/12
```

```{r}
layout(1:2)
plot(Maine.month.ts, ylab = "unemployed (%)")
plot(Maine.annual.ts, ylab = "unemployed (%)")
```

```{r}
Maine.Feb <- window(Maine.month.ts, start = c(1996,2), freq = TRUE)
Maine.Aug <- window(Maine.month.ts, start = c(1996,8), freq = TRUE)
Feb.ratio <- mean(Maine.Feb) / mean(Maine.month.ts)
Aug.ratio <- mean(Maine.Aug) / mean(Maine.month.ts)
```
```{r}
Feb.ratio
```
```{r}
Aug.ratio
```

```{r}
# www <- "http://www.massey.ac.nz/~pscowper/ts/USunemp.dat"
www <- "DATA_ALL/USunemp.dat"
US.month <- read.table(www, header = T)
attach(US.month)
US.month.ts <- ts(USun, start=c(1996,1), end=c(2006,10), freq = 12)
plot(US.month.ts, ylab = "unemployed (%)")
```
### 1.4.3_Multiple time series: Electricity, beer and chocolate data 24
```{r}
# www <- "http://www.massey.ac.nz/~pscowper/ts/cbe.dat"
www <- "DATA_ALL/cbe.dat"
CBE <- read.table(www, header = T)
```
```{r}
CBE[1:4,]
```
```{r}
class(CBE)
```
```{r}
Elec.ts <- ts(CBE[, 3], start = 1958, freq = 12)
Beer.ts <- ts(CBE[, 2], start = 1958, freq = 12)
Choc.ts <- ts(CBE[, 1], start = 1958, freq = 12)
plot(cbind(Elec.ts, Beer.ts, Choc.ts))
```

```{r}
AP.elec <- ts.intersect(AP, Elec.ts)
```
```{r}
start(AP.elec)
```
```{r}
end(AP.elec)
```
```{r}
AP.elec[1:3, ]
AP <- AP.elec[,1]; Elec <- AP.elec[,2]
layout(1:2)
plot(AP, main = "", ylab = "Air passengers / 1000 ' s")
plot(Elec, main = "", ylab = "Electricity production / MkWh")
```
```{r}
plot(as.vector(AP), as.vector(Elec),
     xlab = "Air passengers / 1000 ' s",
     ylab = "Electricity production / MWh")
abline(reg = lm(Elec ~ AP))
cor(AP, Elec)
```
### 1.4.4_Quarterly exchange rate: GBP to NZ dollar 28
### 1.4.5_Global temperature series 30
## 1.5_Decomposition of series 33
### 1.5.1 Notation 33
### 1.5.2 Models 33
### 1.5.3 Estimating trends and seasonal effects 34
### 1.5.4 Smoothing 35
### 1.5.5 Decomposition in R 36
## 1.6_Summary of commands used in examples 38
## 1.7_Exercises 38
